---
layout:     post
title:      数据库—Chapter 2 ER Model
subtitle:   数据库碎碎念
date:       2021-03-14
author:     小熊pink
header-img: img/the-first.png
catalog:   true
tags:
    - 数据库
---

## 2.1 **The Entity-Relationship Model**

The **entity-relationship (E-R)** data model was developed to facilitate database design by allowing specification of an *enterprise schema* that represents the overall logical structure of a database.



Using ER model, A database can be modeled as:

- a collection of **entities**,
- **relationship** among the entities.

The model describes data to be stored and the constraints over the data.



Three basic concepts:

- entity sets
- relationship sets
- attributes

The E-R model has an associated diagrammatic representation, the E-R diagram.



### 2.1.1 Entity Sets

An **entity** is a "thing" or "object" in the real world that is distinguishable from all other objects.

concrete / abstract

An entity has a set of properties, and the values for some set of properties may uniquely identify an entity.



An **entity set** is a set of entities of the same type that share the same properties, or attributes.

In the process of modeling, we often use the term *entity set* in the <u>abstract</u>, without referring to a particular set of individual entities.
We use the term **extension** of the entity set to refer to the actual collection of entities belonging to the entity set.

- entity set：抽象
- extension of the entity set：实体

Entity sets do not need to be disjoint.



An entity is represented by a set of **attributes**.

Attributes are descriptive properties possessed by each member of an entity set.



Each entity has a **value** for each of its attributes.



### 2.1.2 Relationship Sets

A **relationship** is an association among several entities.



A **relationship set** is a set of relationships of the same type.

Formally, it is a mathematical relation on n $\geq$ 2 (possibly nondistinct) entity sets.



If $E_1, E_2, ..., E_n$ are entity sets, then a relationship set R is a <u>subset</u> of

$｛(e_1, e_2, ..., e_n)|e_1 \in E_1, e_2 \in E_2, ..., e_n \in E_n｝$

where $(e_1, e_2, ..., e_n)$ is a relationship.

The entity sets $E_1, E_2, ..., E_n$ **participate** in relationship set R.



The function that an entity plays in a relationship is called that entity's **role**. (usually implicit and not specified)

a **recursive** relationship set: the same entity set participates in a relationship set more than once, in different roles. (explicit role names should be specified)



A relationship may also have attributes called **descriptive attributes**.

A relationship instance in a given relationship set must be uniquely identifiable from its participating entities, without using the descriptive attributes.



It is possible to have more than one relationship set involving the same entity sets.



The number of entity sets that participate in a relationship set is the **degree** of the relationship set.

Relationship sets that involve two entity sets are binary (or degree two). Most relationships are binary.

In general, any non-binary relationship can be represented using binary relationships by creating an artificial entity set.



### 2.1.3 Attributes

For each attribute, there is a set of permitted values, called the **domain**, or **value set**, of that attribute.

Formally, an attribute of an entity set is a function that maps from the entity set into a domain.



An attribute, as used in the E-R model, can be characterized by the following attribute types:

- Simple and composite attributes
- Single-valued and multivalued attributes
- Derived attribute



An attribute takes a **null** value when an entity does not have a value for it.

- the value does not exist for the entity
- missing
- unknown



## 2.2 **Constraints**

### 2.2.1 Mapping Cardinalities

**Mapping cardinalities**, or cardinality ratios, express the number of entities to which another entity can be associated via a relationship set.

For a binary relationship set R between entity sets A and B, the mapping cardinality must be one of the following:

- One-to-one
- One-to-many
- Many-to-one
- Many-to-Many



### 2.2.2 Participation Constraints

The participation of an entity set E in a relationship set R is said to be **total** if every entity in E participates in at least one relationship in R.

The participation of the entity set E in relationship R is said to be **partial** if only some entities in E participate in relationships in R.



### 2.2.3 Keys

#### Keys for Entity sets

A key for an entity is a set of attributes that suffice to distinguish entities from each other.



**Composite Key**: Two or more attributes are used to serve as a key



The concepts of superkey, candidate key, and primary key are applicable to entity sets just as they are applicable to relation schemas.

- A **superkey** is a set of one or more attributes that, taken collectively, allow us to identify uniquely a tuple in the relation. 
- We are often interested in superkeys for which no proper subset is a superkey. Such minimal superkeys are called **candidate keys**.
- We shall use the term **primary key** to denote a candidate key that is chosen by the database designer as the principal means of identifying tuples within a relation.



#### Keys for Relationship Sets

Key of a relationship set: A set of attributes that can uniquely identify relationships from each other.
The combination of primary keys of the participating entity sets forms a key of a relationship set.

Must consider the mapping cardinality of the relationship set when deciding what are the candidate keys. 



Let R be a relationship set involving entity sets $E_1, E_2, ..., E_n$. Let *primary key($E_i$)* denote the set of attributes that forms the primary key for entity set $E_i$.

If the relationship set R has no attributes associated with it, then the set of attributes *primary-key*($E_1$) $\cup$ *primary-key*($E_2$) $\cup$ ... $\cup$ *primary-key*($E_n$) describes an individual relationship in set R.

If the relationship set T has attributes $a_1, a_2, ..., a_m$ associated with it, then the set of attributes *primary-key*($E_1$) $\cup$ *primary-key*($E_2$) $\cup$ ... $\cup$ *primary-key*($E_n$) <$\cup$ $\{a_1, a_2, ..., a_m\}$> describes an individual relationship in the set R.

If the attribute names of primary keys are not unique across entity sets, the attributes are renamed to distinguish them.

- The name of the entity set combined with the name of the attribute would form a unique name.

- If an entity set participates more than once in a relationship set, the role name is used instead of the entity set, to form a unique attribute name.



## 2.3 **E-R Diagrams**

An **E-R diagram** can express the overall logical structure of a database graphically.



### 2.3.1 Basic Structure

major components:

- **Rectangles** represent entity sets.
  - **Single rectangles** represent strong entity sets.
  - **Double rectangles** represent weak entity sets.
- **Diamonds** represent relationship sets.
  - **Double diamonds** represent identifying relationship set.
- **Lines** link attributes to entity sets and entity sets to relationship sets.
  - a **directed line** represents “one” (cardinality constraints)
  - an **undirected line** represents “many” (cardinality constraints)
  - a **double line** indicates total participation. (participation constraints)
  - a **single line** indicates partial participation. (participation constraints)
- **Ellipses** represent attributes
  - **Double ellipses** represent multivalued attributes.
  - **Dashed ellipses** denote derived attributes.
- **Underline** indicates primary key attributes



### 2.3.2 Weak Entity Sets

An entity set that does not have sufficient attributes to form a primary key is termed a **weak entity set**.

An entity set that has a primary key is termed a **strong entity set**.



For a weak entity set to be meaningful, it must be associated with another entity set, called the **identifying entity set** or **owner entity set**. 

Every weak entity must be associated with an identifying entity; that is, the weak entity set is said to be **existence dependent** on the identifying entity set.

The identifying entity set is said to **own** the weak entity set that it identifies.

We need a means of distinguishing among all those entities in the weak entity set that depend on one particular strong entity. The **discriminator** / **partial key** of a weak entity set is a set of attributes that allows this distinction to be made.



The relationship associating the weak entity set with the identifying entity set is called the **identifying relationship**.

- The identifying relationship is many-to-one （one-to-one可吗）from the weak entity set to the identifying entity set, and the participation of the weak entity set in the relationship is total.
- The identifying relationship set should not have any descriptive attributes, since any such attributes can instead be associated with the weak entity set. (one+total)



## 2.4 **Extended E-R Features (Class Hierarchy)**

### 2.4.1 Specialization

The process of designating subgroupings within an entity set is called **specialization**.

An entity may belong to multiple specialized entity sets: **overlapping specialization**.

An entity must belong to at most one specialized entity set: **disjoint specialization**.



### 2.4.2 Generalization

Express commonality by generalization.

Higher- and lower-level entity sets also may be designated by the terms **superclass** and **subclass**, respectively.



### 2.4.3 Attribute Inheritance

A crucial property of the higher- and lower-level entities created by specialization and generalization is **attribute inheritance**.

The attributes of the higher-level entity sets are said to be **inherited** by the lower-level entity sets.

**single inheritance**

**multiple inheritance**



### 2.4.4 Constraints on Generalizations

Determine which entities can be members of a given lower-level entity set:

- **Condition-defined** / **attribute-defined**
- **User-defined**

Whether or not entities may belong to more than one lower-level entity set within a single generalization:

- **Disjoint**
- **Overlapping**

**completeness constraint**:

- **Total generalization or specialization**
- **Partial generalization or specialization**



### 2.4.5 Reason why we use class hierarchy

- Add descriptive attribute that make sense only for the entities in a subclass
- Identify the set of entities that participate in some relationships
